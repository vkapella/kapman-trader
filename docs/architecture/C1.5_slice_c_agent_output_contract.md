üìò KapMan Slice C ‚Äî Agent Output Contract

Status: Draft (ready to freeze)
Scope: Planning & orchestration layer (not scoring math, not indicators)

‚∏ª

1. Purpose

This contract defines the required structure, semantics, and constraints of all AI-generated trade recommendations produced in Slice C.

It ensures that:
	‚Ä¢	Outputs are deterministic, auditable, and scorable
	‚Ä¢	Discipline is preserved under uncertainty
	‚Ä¢	No downstream agent can re-interpret intent
	‚Ä¢	Recommendations can be ranked, backtested, and reviewed

This contract governs what agents emit, not how signals are computed.

‚∏ª

2. Core Output Principles (Non-Negotiable)
	1.	Every output must include a Primary recommendation
	2.	Alternatives are required when a trade is blocked
	3.	NO_TRADE is a first-class, scorable outcome
	4.	Confidence is relative, not probabilistic
	5.	All reasoning must be traceable to rules and clusters
	6.	Missing data must be explicitly declared
	7.	No inference is allowed from missing data

‚∏ª

3. Output Structure (Canonical)

Each agent response must conform to the following top-level structure:

KapMan Trade Recommendation
‚îú‚îÄ‚îÄ Snapshot Metadata
‚îú‚îÄ‚îÄ Primary Recommendation
‚îú‚îÄ‚îÄ Alternative Recommendations (0..N)
‚îú‚îÄ‚îÄ Reasoning Trace
‚îú‚îÄ‚îÄ Confidence Summary
‚îú‚îÄ‚îÄ Missing Data Declaration
‚îú‚îÄ‚îÄ Guardrails & Disclaimers


‚∏ª

4. Snapshot Metadata (Required)

Purpose: ensure auditability and reproducibility.

Fields
	‚Ä¢	ticker
	‚Ä¢	snapshot_time
	‚Ä¢	model_version
	‚Ä¢	wyckoff_regime
	‚Ä¢	wyckoff_primary_event
	‚Ä¢	data_completeness_flags

No interpretation allowed here ‚Äî metadata only.

‚∏ª

5. Primary Recommendation (Required)

The highest-confidence outcome.

Required fields
	‚Ä¢	action
One of: ENTER, WAIT, DEFER, NO_TRADE
	‚Ä¢	strategy_class
(May be NONE if NO_TRADE)
	‚Ä¢	direction
BULLISH, BEARISH, or NEUTRAL
	‚Ä¢	confidence_score
Relative (0‚Äì100), highest in set
	‚Ä¢	time_horizon
(short / medium / long ‚Äî descriptive only)
	‚Ä¢	rationale_summary
‚â§ 3 sentences, non-narrative

Rules
	‚Ä¢	If Wyckoff vetoed ‚Üí action = NO_TRADE
	‚Ä¢	If dealer vetoed ‚Üí action ‚â† ENTER
	‚Ä¢	If extreme IV ‚Üí long-premium forbidden as primary

‚∏ª

6. Alternative Recommendations (Conditional, Scorable)

Alternatives must be emitted when a trade is blocked or downgraded, or when materially different expressions are viable.

Each alternative must be fully formed and scorable.

Required fields (per alternative)
	‚Ä¢	label (e.g., ‚ÄúTA-based continuation‚Äù, ‚ÄúCounter-IV play‚Äù)
	‚Ä¢	action
	‚Ä¢	strategy_class
	‚Ä¢	direction
	‚Ä¢	confidence_score
Must be lower than primary
	‚Ä¢	blocking_reason
Why this is not primary
	‚Ä¢	promotion_conditions
What would need to change

Rules
	‚Ä¢	Alternatives never exceed primary confidence
	‚Ä¢	Alternatives must not violate hard constraints
	‚Ä¢	At least one alternative required when:
	‚Ä¢	Wyckoff says NO_TRADE
	‚Ä¢	IV forbids preferred strategy
	‚Ä¢	Dealer blocks timing

‚∏ª

7. Reasoning Trace (Mandatory, Structured)

This replaces narrative explanation.

Required subsections

a) Fired Rules
Explicit list of rule IDs from the Rule Catalog:

Fired Rules:
- WYC-03 (Structural veto)
- TA-05 (TA alternative thesis)
- VOL-01 (Extreme IV forbid)

b) Cluster Contributions
For each decision-grade cluster:

Cluster Contributions:
- Wyckoff: VETO
- Trend: NEUTRAL
- Momentum: NEGATIVE
- Volatility: FORBID_LONG_PREMIUM
- Dealer: TIMING_VETO

c) Blocking vs Supporting Factors
Explicit separation:

Supporting Factors:
- Compression present
Blocking Factors:
- Gamma flip proximity
- Extreme IV

This section must be machine-parsable.

‚∏ª

8. Confidence Summary

Purpose: make confidence semantics explicit.

Required fields
	‚Ä¢	confidence_type: RELATIVE
	‚Ä¢	ranking_basis: ‚ÄúPrimary outranks alternatives by construction‚Äù
	‚Ä¢	confidence_gap_notes (if applicable)

No probabilities. No adjectives like ‚Äúhighly likely‚Äù.

‚∏ª

9. Missing Data Declaration (Mandatory)

Purpose: prevent hallucination and false inference.

Required format

Missing Data:
- Dealer metrics: NOT COMPUTED
- Volatility term structure: NOT COMPUTED

Rules:
	‚Ä¢	Missing ‚â† bearish
	‚Ä¢	Missing ‚â† bullish
	‚Ä¢	Missing only introduces uncertainty penalties already reflected in confidence

‚∏ª

10. Guardrails & Disclaimers (Standard Block)

This block must be identical across all outputs.

Required language (paraphrasing allowed, meaning fixed)
	‚Ä¢	This recommendation is rule-based, not predictive
	‚Ä¢	It is conditioned only on computed inputs
	‚Ä¢	It does not guarantee execution, fills, or outcomes
	‚Ä¢	It does not replace position sizing or risk controls
	‚Ä¢	It reflects current conditions only

This protects against misuse and misinterpretation.

‚∏ª

11. Explicitly Rejected Output Patterns

Agents must not emit:
	‚Ä¢	Probabilistic claims (‚Äú70% chance‚Äù, ‚Äúlikely‚Äù)
	‚Ä¢	Indicator voting summaries
	‚Ä¢	Narrative intuition (‚Äúmarket feels strong‚Äù)
	‚Ä¢	Single recommendation without alternatives (when blocked)
	‚Ä¢	Strategy suggestions without IV gating

These are violations of the contract.

‚∏ª

12. Why this belongs in Slice C

This contract:
	‚Ä¢	Defines planning-layer behavior
	‚Ä¢	Enables agent orchestration
	‚Ä¢	Allows scoring and learning later
	‚Ä¢	Prevents regression into narrative AI outputs

It is not:
	‚Ä¢	signal logic (Slice B)
	‚Ä¢	tuning logic (Slice D)
	‚Ä¢	execution logic

‚∏ª
